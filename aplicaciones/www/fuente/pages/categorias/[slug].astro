---
import FiltrosHistoriaOral from '@/componentes/FiltrosHistoriaOral.astro';
import TituloPagina from '@/componentes/TituloPagina.astro';
import Plantilla from '@/plantillas/Plantilla.astro';
import type { CategoriasWP } from '@/tipos';
import { gql, pedirDatos } from '@/utilidades/ayudas';

const categoria = 'Categor√≠a';
export async function getStaticPaths() {
  const PeticionCategorias = gql`
    query {
      categories(where: { hideEmpty: true }, first: 200) {
        nodes {
          name
          slug
        }
      }
    }
  `;
  const { categories } = await pedirDatos<{ categories: CategoriasWP }>(PeticionCategorias);

  return categories.nodes.map(({ slug }) => {
    return { params: { slug } };
  });
}

const { slug } = Astro.params;

const Categoria = gql`
  query {
    category(id: "${slug}", idType: SLUG) {
      name
    }
  }
`;

const { category } = await pedirDatos<{ category: { name: string } }>(Categoria);
---

<Plantilla titulo={category.name} descripcion={categoria}>
  <div class="paginaConMenuIzquierdo">
    <aside class="menuIzquierdo">
      <TituloPagina titulo={category.name} slug={slug} modo="oscuro" />
      <FiltrosHistoriaOral />
    </aside>

    <main class="col2">
      <h1>{category.name}</h1>
    </main>
  </div>
</Plantilla>

<style lang="scss">
  .paginaCategorias {
    display: flex;
  }

  .contenido {
    padding: 1em 2em 5em 2em;
  }
</style>
